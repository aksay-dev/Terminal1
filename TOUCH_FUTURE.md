# üì¶ –§–∞–π–ª—ã —Ç–∞—á—Å–∫—Ä–∏–Ω–∞ GT911 (–¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

## ‚ÑπÔ∏è –°—Ç–∞—Ç—É—Å

–î—Ä–∞–π–≤–µ—Ä —Ç–∞—á—Å–∫—Ä–∏–Ω–∞ GT911 **–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω**, –Ω–æ **–æ—Ç–∫–ª—é—á–µ–Ω** –≤ —Ç–µ–∫—É—â–µ–π —Å–±–æ—Ä–∫–µ –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –ø–∞–º—è—Ç—å—é LVGL v9.

–§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
- ‚úÖ `main/touch.c` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ GT911
- ‚úÖ `main/touch.h` - API —Ç–∞—á—Å–∫—Ä–∏–Ω–∞
- üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–∞—á—Å–∫—Ä–∏–Ω—É

## üö´ –ü–æ—á–µ–º—É –æ—Ç–∫–ª—é—á–µ–Ω

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–∞—á—Å–∫—Ä–∏–Ω–∞ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞:
```
[Error] lv_draw_add_task: Out of memory
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. LVGL v9 —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏ —á–µ–º v8
2. Full-screen –±—É—Ñ–µ—Ä (460KB) + —Ç–∞—á—Å–∫—Ä–∏–Ω + –≤–∏–¥–∂–µ—Ç—ã = —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ
3. –ù—É–∂–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏

## üìÅ –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### main/touch.c
–ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞ GT911:
- ‚úÖ I2C –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (400 kHz)
- ‚úÖ –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞
- ‚úÖ –ß—Ç–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (X/Y swap, –∏–Ω–≤–µ—Ä—Å–∏—è)

### main/touch.h
API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–∞—á—Å–∫—Ä–∏–Ω–æ–º:
```c
bool touch_init(void);
bool touch_has_signal(void);
bool touch_touched(void);
bool touch_released(void);
extern int16_t touch_last_x, touch_last_y;
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `TOUCHSCREEN.md` - –æ–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- `TOUCH_DEBUG.md` - –æ—Ç–ª–∞–¥–∫–∞
- `TOUCH_FIX.md` - –±—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `TOUCH_WORKING.md` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- `SOLUTION.md` - —Ä–∞–∑–±–æ—Ä –ø—Ä–æ–±–ª–µ–º

## üîß –ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å —Ç–∞—á—Å–∫—Ä–∏–Ω –≤ –±—É–¥—É—â–µ–º

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–£–º–µ–Ω—å—à–∏—Ç—å –±—É—Ñ–µ—Ä –¥–∏—Å–ø–ª–µ—è** –≤ `display.c`:
   ```c
   // –í–º–µ—Å—Ç–æ full-screen (460KB):
   size_t buf_pixels = LCD_H_RES * 100;  // 1/4 —ç–∫—Ä–∞–Ω–∞ = 115KB
   lv_display_set_buffers(s_lv_display, buf1, NULL, 
                          buf_pixels * sizeof(lv_color_t), 
                          LV_DISPLAY_RENDER_MODE_PARTIAL);
   ```

2. **–í–∫–ª—é—á–∏—Ç—å —Ç–∞—á—Å–∫—Ä–∏–Ω** –≤ `main/CMakeLists.txt`:
   ```cmake
   idf_component_register(SRCS "main.c" "display.c" "touch.c"
                          INCLUDE_DIRS "."
                          REQUIRES lvgl esp_lcd esp_timer driver)
   ```

3. **–î–æ–±–∞–≤–∏—Ç—å –≤ `main.c`:**
   ```c
   #include "touch.h"
   
   // –í app_main():
   touch_init();
   
   lv_indev_t *indev = lv_indev_create();
   lv_indev_set_type(indev, LV_INDEV_TYPE_POINTER);
   lv_indev_set_read_cb(indev, touchpad_read_cb);
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£–≤–µ–ª–∏—á–∏—Ç—å PSRAM allocation

–í `sdkconfig` –∏–ª–∏ —á–µ—Ä–µ–∑ `idf.py menuconfig`:
```
Component config ‚Üí ESP PSRAM ‚Üí 
  ‚Üí SPIRAM malloc alwaysinternal threshold = 0
```

–≠—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PSRAM –¥–ª—è –≤—Å–µ—Ö –±–æ–ª—å—à–∏—Ö –∞–ª–ª–æ–∫–∞—Ü–∏–π.

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LVGL v8

LVGL v8 —Ç—Ä–µ–±—É–µ—Ç –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏. –û—Ç–∫–∞—Ç–∏—Ç–µ—Å—å –∫ v8 –≤ `main/idf_component.yml`:
```yaml
dependencies:
  lvgl/lvgl: ^8.3.0
```

## üìä –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è (–±–µ–∑ —Ç–∞—á—Å–∫—Ä–∏–Ω–∞)

**–†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ:**
- ‚úÖ –î–∏—Å–ø–ª–µ–π ST7701 RGB 480x480
- ‚úÖ –í—ã–≤–æ–¥ "Hello, World!"
- ‚úÖ –ö–Ω–æ–ø–∫–∞ (–≤–∏–∑—É–∞–ª—å–Ω–∞—è)
- ‚úÖ –®—Ä–∏—Ñ—Ç—ã 18, 20, 24, 48
- ‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫ –ø–∞–º—è—Ç–∏

**–û—Ç–∫–ª—é—á–µ–Ω–æ:**
- ‚è∏Ô∏è –¢–∞—á—Å–∫—Ä–∏–Ω GT911
- ‚è∏Ô∏è –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∫–Ω–æ–ø–∫–∏
- ‚è∏Ô∏è –°—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–î–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö:**
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –±–µ–∑ —Ç–∞—á—Å–∫—Ä–∏–Ω–∞ - –æ–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞ –∏ —Ö–æ—Ä–æ—à–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –æ—Å–Ω–æ–≤ LVGL.

**–î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö:**
–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç 1 (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏) - —É–º–µ–Ω—å—à–∏—Ç–µ –±—É—Ñ–µ—Ä –¥–∏—Å–ø–ª–µ—è –¥–æ partial rendering.

**–î–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ç–æ—Ä–æ–≤:**
–ò–∑—É—á–∏—Ç–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –≤ `touch.c` - —Ç–∞–º –≥–æ—Ç–æ–≤—ã–π —Ä–∞–±–æ—á–∏–π –¥—Ä–∞–π–≤–µ—Ä GT911, –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –ø–∞–º—è—Ç—å—é.

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–í—Å–µ —Ñ–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ —Ç–∞—á—Å–∫—Ä–∏–Ω—É –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ:
- `TOUCHSCREEN.md`
- `TOUCH_DEBUG.md`
- `TOUCH_FIX.md`
- `TOUCH_WORKING.md`
- `SOLUTION.md`

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏—Ö –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞—á—Å–∫—Ä–∏–Ω!

---

**–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! –°–æ–±–µ—Ä–∏—Ç–µ –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–º "Hello, World!" üéâ**

